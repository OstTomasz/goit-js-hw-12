{"version":3,"file":"01-gallery.js","sources":["../src/01-gallery.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('#form');\nconst input = document.querySelector('#form-input');\nconst loader = document.querySelector('#loader');\nconst gallery = document.querySelector('#gallery');\nconst moreBtn = document.querySelector('#more');\n\nlet scrollBy = 0;\nlet searchString = '';\nlet pageIndex = 0;\nconst per_page = 15;\nconst APIURL = `https://pixabay.com/api/`;\n\nconst element = (tag, props) =>\n  Object.assign(document.createElement(tag), props);\n\nconst createGalEl = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  const elemLink = element('a', {\n    className: 'lightbox-link',\n    href: largeImageURL,\n  });\n  const galEl = element('li', { className: 'result' });\n\n  const img = element('img', {\n    className: 'result-pic',\n    src: webformatURL,\n    alt: tags,\n  });\n\n  const description = element('div', { className: 'result-desc' });\n\n  const likesEl = element('div', { className: 'desc-el' });\n  const likesHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Likes',\n  });\n  const likesVal = element('p', {\n    className: 'desc-value',\n    textContent: likes,\n  });\n\n  likesEl.append(likesHead, likesVal);\n\n  const viewsEl = element('div', { className: 'desc-el' });\n  const viewsHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Views',\n  });\n  const viewsVal = element('p', {\n    className: 'desc-value',\n    textContent: views,\n  });\n\n  viewsEl.append(viewsHead, viewsVal);\n\n  const comEl = element('div', { className: 'desc-el' });\n  const comHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Comments',\n  });\n  const comVal = element('p', {\n    className: 'desc-value',\n    textContent: comments.toString(),\n  });\n\n  comEl.append(comHead, comVal);\n\n  const downloadEl = element('div', { className: 'desc-el' });\n  const downloadHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Downloads',\n  });\n  const downloadVal = element('p', {\n    className: 'desc-value',\n    textContent: downloads,\n  });\n\n  downloadEl.append(downloadHead, downloadVal);\n\n  description.append(likesEl, viewsEl, comEl, downloadEl);\n\n  elemLink.append(img);\n  galEl.append(elemLink, description);\n\n  return galEl;\n};\n\nconst renderElements = (images, rootList) => {\n  const fragment = document.createDocumentFragment();\n  fragment.append(...images.map(createGalEl));\n\n  rootList.append(fragment);\n};\n\nlet lightbox = new SimpleLightbox('#gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  animationSpeed: 250,\n  fadeSpeed: 250,\n  scrollZoom: false,\n});\n\nconst getPics = async () => {\n  try {\n    pageIndex++;\n    const params = new URLSearchParams({\n      key: '35169635-92091552d9eccdba3eb57d7a9',\n      q: searchString,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: pageIndex,\n      per_page: per_page,\n    });\n    return (await axios.get(`${APIURL}?${params}`)).data.hits;\n  } catch (error) {\n    iziToast.error({\n      message: 'Oh no! There is an error: ' + error.message,\n    });\n  }\n};\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  searchString = input.value.trim();\n  gallery.innerHTML = '';\n  pageIndex = 0;\n  scrollBy = 0;\n  input.value = '';\n  moreBtn.classList.add('visibility');\n  if (searchString !== '') {\n    loader.classList.remove('visibility');\n    (async () => {\n      try {\n        const data = await getPics();\n        renderElements(data, gallery);\n        loader.classList.add('visibility');\n        lightbox.refresh();\n        if (data.length >= per_page) {\n          moreBtn.classList.remove('visibility');\n        } else {\n          if (gallery.childElementCount > 0)\n            iziToast.info({\n              message:\n                \"We're sorry, but you've reached the end of search results.\",\n            });\n        }\n        if (data.length === 0) {\n          iziToast.error({\n            message:\n              'Sorry, there are no images matching your search query. Please try again!',\n          });\n        }\n        scrollBy =\n          2 * document.querySelector('.result').getBoundingClientRect().height;\n      } catch (error) {\n        console.log(error.message);\n      }\n    })();\n  } else {\n    iziToast.info({\n      message: 'Type correct search params!',\n    });\n  }\n});\n\nmoreBtn.addEventListener('click', () => {\n  loader.classList.remove('visibility');\n  (async () => {\n    try {\n      const data = await getPics();\n      renderElements(data, gallery);\n      loader.classList.add('visibility');\n      window.scrollBy({ top: scrollBy, behavior: 'smooth' });\n      lightbox.refresh();\n      if (data.length < per_page) {\n        moreBtn.classList.add('visibility');\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n    } catch (error) {\n      iziToast.error({\n        message: 'Oh no! There is an error: ' + error.message,\n      });\n    }\n  })();\n});\n"],"names":["form","input","loader","gallery","moreBtn","scrollBy","searchString","pageIndex","per_page","APIURL","element","tag","props","createGalEl","webformatURL","largeImageURL","tags","likes","views","comments","downloads","elemLink","galEl","img","description","likesEl","likesHead","likesVal","viewsEl","viewsHead","viewsVal","comEl","comHead","comVal","downloadEl","downloadHead","downloadVal","renderElements","images","rootList","fragment","lightbox","SimpleLightbox","getPics","params","axios","error","iziToast","data"],"mappings":"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"}