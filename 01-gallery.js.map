{"version":3,"file":"01-gallery.js","sources":["../src/01-gallery.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('#form');\nconst input = document.querySelector('#form-input');\nconst loader = document.querySelector('#loader');\nconst gallery = document.querySelector('#gallery');\nconst moreBtn = document.querySelector('#more');\n\nlet searchString = '';\nlet pageIndex = 0;\nconst per_page = 15;\nconst APIURL = `https://pixabay.com/api/`;\n\nconst element = (tag, props) =>\n  Object.assign(document.createElement(tag), props);\n\nconst createGalEl = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  const elemLink = element('a', {\n    className: 'lightbox-link',\n    href: largeImageURL,\n  });\n  const galEl = element('li', { className: 'result' });\n\n  const img = element('img', {\n    className: 'result-pic',\n    src: webformatURL,\n    alt: tags,\n  });\n\n  const description = element('div', { className: 'result-desc' });\n\n  const likesEl = element('div', { className: 'desc-el' });\n  const likesHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Likes',\n  });\n  const likesVal = element('p', {\n    className: 'desc-value',\n    textContent: likes,\n  });\n\n  likesEl.append(likesHead, likesVal);\n\n  const viewsEl = element('div', { className: 'desc-el' });\n  const viewsHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Views',\n  });\n  const viewsVal = element('p', {\n    className: 'desc-value',\n    textContent: views,\n  });\n\n  viewsEl.append(viewsHead, viewsVal);\n\n  const comEl = element('div', { className: 'desc-el' });\n  const comHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Comments',\n  });\n  const comVal = element('p', {\n    className: 'desc-value',\n    textContent: comments.toString(),\n  });\n\n  comEl.append(comHead, comVal);\n\n  const downloadEl = element('div', { className: 'desc-el' });\n  const downloadHead = element('p', {\n    className: 'desc-header',\n    textContent: 'Downloads',\n  });\n  const downloadVal = element('p', {\n    className: 'desc-value',\n    textContent: downloads,\n  });\n\n  downloadEl.append(downloadHead, downloadVal);\n\n  description.append(likesEl, viewsEl, comEl, downloadEl);\n\n  elemLink.append(img);\n  galEl.append(elemLink, description);\n\n  return galEl;\n};\n\nconst renderElements = (images, rootList) => {\n  const fragment = document.createDocumentFragment();\n  fragment.append(...images.map(createGalEl));\n\n  rootList.append(fragment);\n};\n\nlet lightbox = new SimpleLightbox('#gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  animationSpeed: 250,\n  fadeSpeed: 250,\n  scrollZoom: false,\n});\n\nconst getPics = async () => {\n  try {\n    pageIndex++;\n    const params = new URLSearchParams({\n      key: '35169635-92091552d9eccdba3eb57d7a9',\n      q: searchString,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: pageIndex,\n      per_page: per_page,\n    });\n    return (await axios.get(`${APIURL}?${params}`)).data.hits;\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      message: 'Oh no! There is an error: ' + error,\n    });\n  }\n};\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  searchString = input.value.trim();\n  pageIndex = 0;\n\n  if (searchString !== '') {\n    loader.classList.remove('visibility');\n    getPics().then(hits => {\n      loader.classList.add('visibility');\n      input.value = '';\n      renderElements(hits, gallery);\n      lightbox.refresh();\n      if (hits.length >= per_page) {\n        moreBtn.classList.remove('visibility');\n      } else {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n      if (hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        moreBtn.classList.add('visibility');\n      }\n    });\n  } else {\n    iziToast.info({\n      message: 'Type correct search params!',\n    });\n    moreBtn.classList.add('visibility');\n  }\n});\n\nmoreBtn.addEventListener('click', () => {\n  loader.classList.remove('visibility');\n\n  getPics().then(hits => {\n    renderElements(hits, gallery);\n    loader.classList.add('visibility');\n    lightbox.refresh();\n    if (hits.length < per_page) {\n      moreBtn.classList.add('visibility');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  });\n});\n"],"names":["form","input","loader","gallery","moreBtn","searchString","pageIndex","per_page","APIURL","element","tag","props","createGalEl","webformatURL","largeImageURL","tags","likes","views","comments","downloads","elemLink","galEl","img","description","likesEl","likesHead","likesVal","viewsEl","viewsHead","viewsVal","comEl","comHead","comVal","downloadEl","downloadHead","downloadVal","renderElements","images","rootList","fragment","lightbox","SimpleLightbox","getPics","params","axios","error","iziToast","e","hits"],"mappings":"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"}